(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-index"],{"00c3":function(e,t,n){"use strict";n.r(t);var a=n("8d47"),o=n("0f88");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);n("efac");var i,c=n("f0c5"),s=Object(c["a"])(o["default"],a["b"],a["c"],!1,null,"4633b86c",null,!1,a["a"],i);t["default"]=s.exports},"0f88":function(e,t,n){"use strict";n.r(t);var a=n("1f2e"),o=n.n(a);for(var r in a)"default"!==r&&function(e){n.d(t,e,(function(){return a[e]}))}(r);t["default"]=o.a},"1f2e":function(e,t,n){"use strict";var a=n("4ea4");n("d3b7"),n("ddb0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("96cf");var o=a(n("1da1")),r=a(n("6a19")),i=a(n("deda")),c=n("5ffa"),s={data:function(){return{title:"Hello",user:null,from:{username:"",password:"",code:""},desktopImage:"url(./static/medias/desktop/3.jpg)",textType:"password",loginStatus:"account",isFaceFlag:!1}},components:{imgcode:r.default,face:i.default},onLoad:function(){},mounted:function(){},methods:{account_login:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function t(){var n,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.t0=regeneratorRuntime.keys(e.from);case 1:if((t.t1=t.t0()).done){t.next=14;break}if(n=t.t1.value,e.from[n]||"username"!==n){t.next=6;break}return e.$message.error("账号不能为空"),t.abrupt("return");case 6:if(e.from[n]||"password"!==n){t.next=9;break}return e.$message.error("密码不能为空"),t.abrupt("return");case 9:if(e.from[n]||"code"!==n){t.next=12;break}return e.$message.error("验证码不能为空"),t.abrupt("return");case 12:t.next=1;break;case 14:if(a=uni.getStorageSync("imgcode"),a.toLowerCase()===e.from.code.toLowerCase()){t.next=18;break}return e.$message.error("验证码错误"),t.abrupt("return");case 18:return t.next=20,e.Api.sendUniCloud({model:"login",event:{type:e.loginStatus,username:e.from.username,password:e.from.password}});case 20:if(o=t.sent,o.status){t.next=24;break}return e.$message.error(o.mes),t.abrupt("return");case 24:e.$store.commit("login",o.data),e.$message({message:"登录成功",type:"success",duration:1e3,onClose:function(){console.log("跳转"),uni.redirectTo({url:"/pages/home/index"})}});case 26:case"end":return t.stop()}}),t)})))()},changeType:function(){this.textType="password"===this.textType?"text":"password"},to_face:function(){this.isFaceFlag=!0},handlefaceClose:function(){console.log("取消"),this.isFaceFlag=!1,(0,c.cancalCloseVideo)()},face_login:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loginStatus="face",t.next=3,e.Api.sendUniCloud({model:"login",event:{type:e.loginStatus,image:(0,c.takePhoto)()}},!1);case 3:if(n=t.sent,n.status){t.next=7;break}return e.$message.error(n.mes),t.abrupt("return");case 7:if(e.isFaceFlag){t.next=10;break}return console.log("已关闭扫脸弹框"),t.abrupt("return");case 10:if(n.faceFlag||!e.isFaceFlag){t.next=14;break}return e.$message.error(n.mes),e.face_login(),t.abrupt("return");case 14:(0,c.cancalCloseVideo)(),e.isFaceFlag=!1,e.$store.commit("login",n.data),e.$message({message:"登录成功",type:"success",duration:1e3,onClose:function(){console.log("跳转"),uni.redirectTo({url:"/pages/home/index"})}});case 18:case"end":return t.stop()}}),t)})))()}}};t.default=s},"23a8":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n("5ffa"),o={props:{isFaceFlag:!1},data:function(){return{scanlineTop:0}},mounted:function(){var e=this;setInterval((function(){100===e.scanlineTop&&(e.scanlineTop=0),e.scanlineTop=e.scanlineTop+1}),20),this.$nextTick((function(){(0,a.getMedia)(e.faceCallback)}))},methods:{handlefaceClose:function(){this.$emit("faceClose",!1)},facelogin:function(){this.$emit("enter",!1)},faceCallback:function(e){console.log(e,"扫描"),e&&this.$emit("enter")},videoErrorCallback:function(e){console.log(e,"err")}}};t.default=o},"27ca":function(e,t,n){var a=n("24fb");t=a(!1),t.push([e.i,"[data-v-1ec2b934] .el-dialog{background-color:rgba(157,202,207,.41)!important;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px);border-radius:10px}.faceBox[data-v-1ec2b934]{padding:30px}.faceBox .scanBox[data-v-1ec2b934]{width:300px;height:400px;background-color:rgba(215,226,230,.12);border:4px dashed #7efbfc;position:relative;box-shadow:-1px -4px 19px 1px #9fcee2}.faceBox .scanBox .scanline[data-v-1ec2b934]{width:100%;height:0;border:2px dashed #7efbfc;position:absolute}",""]),e.exports=t},"37d8":function(e,t,n){"use strict";n.r(t);var a=n("4822"),o=n.n(a);for(var r in a)"default"!==r&&function(e){n.d(t,e,(function(){return a[e]}))}(r);t["default"]=o.a},4822:function(e,t,n){"use strict";n("cb29"),n("e25e"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={data:function(){return{width:120,height:40}},mounted:function(){var e=this;setTimeout((function(){e.init()}),1e3)},methods:{init:function(){console.log("start");var e=uni.createCanvasContext("imgcanvas",this),t=this.width,n=this.height;e.setFillStyle("white"),e.setLineWidth(5),e.fillRect(0,0,t,n);for(var a=["A","B","C","D","E","F","G","H","I","J","K","L","I","M","N","O","P","Q","R","S","T","U","V","W","S","Y","Z","1","2","3","4","5","6","7","8","9","0"],o="",r=0;r<4;r++){var i=a[this.rn(0,a.length-1)],c=this.rn(-30,30);e.setFontSize(14),e.setTextBaseline("top"),e.setFillStyle(this.rc(80,150)),e.save(),e.translate(30*r+15,parseInt(n/1.5)),e.rotate(c*Math.PI/180),e.fillText(i,-10,-15),e.restore(),o+=i}uni.setStorage({key:"imgcode",data:o});for(r=0;r<40;r++)e.beginPath(),e.arc(this.rn(0,t),this.rn(0,n),1,0,2*Math.PI),e.closePath(),e.setFillStyle(this.rc(150,200)),e.fill();e.draw(),console.log("end")},rc:function(e,t){var n=this.rn(e,t),a=this.rn(e,t),o=this.rn(e,t);return"rgb("+n+","+a+","+o+")"},rn:function(e,t){return parseInt(Math.random()*(e-t))+t},refresh:function(){this.init()},canvasIdErrorCallback:function(e){console.error(e.detail.errMsg)}}};t.default=a},"4c4c":function(e,t,n){var a=n("24fb");t=a(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.canvas-img-code[data-v-6cf8998c]{display:inline-block;overflow:hidden;width:120px;height:40px}',""]),e.exports=t},"4fa5":function(e,t,n){"use strict";var a;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"canvas-img-code",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.refresh.apply(void 0,arguments)}}},[n("v-uni-canvas",{style:{width:e.width+"px",height:e.height+"px"},attrs:{"canvas-id":"imgcanvas"},on:{error:function(t){arguments[0]=t=e.$handleEvent(t),e.canvasIdErrorCallback.apply(void 0,arguments)}}})],1)},r=[]},"5ffa":function(e,t,n){"use strict";var a;n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("ddb0"),n("2b3d"),Object.defineProperty(t,"__esModule",{value:!0}),t.closeMedia=s,t.getMedia=l,t.takePhoto=d,t.cancalCloseVideo=f;var o=null,r=null,i=null,c=null;function s(){try{a&&a.getTracks()[0].stop()}catch(e){return}}function l(e){o=document.getElementsByClassName("uni-video-video")[0],r=document.getElementById("face_canvas").children[0],console.log(r,"canvas"),i=r.getContext("2d");var t={audio:!1,video:{facingMode:"user",width:300,height:400}},n=function(e){console.log("An error has occurred!",e)};navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(t).then((function(t){console.log(o,1),o.srcObject=t,o.play(),a=t,u(e)})).catch((function(e){console.log(e,"err")})):navigator.getUserMedia?(console.log(2),navigator.getUserMedia(t,(function(t){o.src=t,o.play(),a=t,u(e)}),n)):navigator.mozGetUserMedia?(console.log(3),navigator.mozGetUserMedia(t,(function(t){o.src=window.URL.createObjectURL(t),o.play(),a=t,u(e)}),n)):navigator.msGetUserMedia?(console.log(4),navigator.msGetUserMedia(t,(function(t){o.src=window.URL.createObjectURL(t),o.play(),a=t,u(e)}),n)):navigator.webkitGetUserMedia&&(console.log(5),navigator.webkitGetUserMedia(t,(function(t){o.src=window.URL.createObjectURL(t),o.play(),a=t,u(e)}),n))}function u(e){var t=!1;o&&(t=!0,c="function"===typeof a.stop?a:a.getTracks()[0]),e(t)}function d(){i.drawImage(o,0,0,300,400);var e=r.toDataURL("image/png",1);return e.replace("data:image/png;base64,","")}function f(){console.log("关闭摄像头"),c&&c.stop()}},6245:function(e,t,n){"use strict";var a=n("cebe"),o=n.n(a);o.a},"6a19":function(e,t,n){"use strict";n.r(t);var a=n("4fa5"),o=n("37d8");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);n("6245");var i,c=n("f0c5"),s=Object(c["a"])(o["default"],a["b"],a["c"],!1,null,"6cf8998c",null,!1,a["a"],i);t["default"]=s.exports},"78b0":function(e,t,n){"use strict";var a;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"人脸识别",visible:e.isFaceFlag,width:"50%",center:!0,top:"20vh",modal:!0,"before-close":e.handlefaceClose},on:{"update:visible":function(t){arguments[0]=t=e.$handleEvent(t),e.isFaceFlag=t}}},[n("div",{staticClass:"faceBox flex XcenterYcenter"},[n("div",{staticClass:"scanBox"},[n("v-uni-video",{attrs:{id:"face_video",src:"","show-play-btn":!1,"show-center-play-btn":!1,"enable-danmu":!0,"danmu-btn":!0,controls:!1},on:{error:function(t){arguments[0]=t=e.$handleEvent(t),e.videoErrorCallback.apply(void 0,arguments)}}}),n("v-uni-canvas",{staticStyle:{width:"300px",height:"400px",position:"absolute",top:"0px"},attrs:{id:"face_canvas"}}),n("div",{staticClass:"scanline",style:{top:e.scanlineTop+"%"}})],1)]),n("span",{staticStyle:{color:"#fff","font-size":"20px"},attrs:{slot:"title"},slot:"title"},[e._v("人脸识别")]),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})])},r=[]},"8cc7":function(e,t,n){"use strict";var a=n("e0a4"),o=n.n(a);o.a},"8d47":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a}));var a={imgcode:n("6a19").default},o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"login_content flex XcenterYcenter",style:{backgroundImage:e.desktopImage}},[e.isFaceFlag?e._e():n("div",{staticClass:"loginBox flex YcenterXcenter"},[n("div",{staticClass:"logo"},[n("i",{staticClass:"el-icon-s-platform"}),n("span",[e._v("WUI 个人云桌面")])]),n("div",{staticClass:"form flex YcenterXcenter"},[n("el-input",{staticStyle:{width:"300px","border-radius":"40px","margin-bottom":"15px"},attrs:{placeholder:"请输入账号","prefix-icon":"el-icon-user\n"},model:{value:e.from.username,callback:function(t){e.$set(e.from,"username",t)},expression:"from.username"}}),n("el-input",{staticStyle:{width:"300px","border-radius":"40px"},attrs:{type:e.textType,placeholder:"请输入密码","prefix-icon":"el-icon-lock"},model:{value:e.from.password,callback:function(t){e.$set(e.from,"password",t)},expression:"from.password"}},[n("i",{staticClass:"el-input__icon el-icon-view btn-eye",attrs:{slot:"suffix"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.changeType.apply(void 0,arguments)}},slot:"suffix"})]),n("div",{staticClass:"code flex XcenterYcenter",staticStyle:{"margin-top":"15px"}},[n("el-input",{staticStyle:{width:"170px","margin-right":"10px","border-radius":"40px"},attrs:{placeholder:"请输入验证码","prefix-icon":"el-icon-picture-outline"},model:{value:e.from.code,callback:function(t){e.$set(e.from,"code",t)},expression:"from.code"}}),n("imgcode")],1),n("div",{staticClass:"hide",staticStyle:{"margin-top":"5px",color:"#fff"}},[e._v("看不清？点击图片刷新验证码")]),n("div",{staticClass:"btn flex YcenterXcenter",staticStyle:{width:"100%","margin-top":"30px"}},[n("div",{staticClass:"button",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.account_login.apply(void 0,arguments)}}},[e._v("登录")])]),n("div",{staticClass:"tools flex XcenterYcenter"},[n("div",{staticClass:"tool"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"扫脸登录",placement:"left-end"}},[n("i",{staticClass:"el-icon-camera-solid",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.to_face.apply(void 0,arguments)}}})])],1),n("div",{staticClass:"tool"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"微信授权登录",placement:"left-end"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.to_wechat.apply(void 0,arguments)}}},[n("i",{staticClass:"fa fa-wechat"})])],1)])],1)]),e.isFaceFlag?n("face",{attrs:{isFaceFlag:e.isFaceFlag},on:{enter:function(t){arguments[0]=t=e.$handleEvent(t),e.face_login.apply(void 0,arguments)},faceClose:function(t){arguments[0]=t=e.$handleEvent(t),e.handlefaceClose.apply(void 0,arguments)}}}):e._e()],1)},r=[]},ba5e:function(e,t,n){"use strict";n.r(t);var a=n("23a8"),o=n.n(a);for(var r in a)"default"!==r&&function(e){n.d(t,e,(function(){return a[e]}))}(r);t["default"]=o.a},c260:function(e,t,n){var a=n("c755");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var o=n("4f06").default;o("0e909fbb",a,!0,{sourceMap:!1,shadowMode:!1})},c755:function(e,t,n){var a=n("24fb");t=a(!1),t.push([e.i,".login_content[data-v-4633b86c]{width:100%;height:100vh;\n  /* background-image: url(../../static/image/0.jpg); */background-repeat:no-repeat;background-size:100% 100%}.login_content .loginBox[data-v-4633b86c]{width:600px;background:rgba(20,54,92,.54);border-radius:10px;border:1px solid rgba(235,238,245,.28);box-shadow:2px -2px 19px 1px #143b66;padding:20px 0}.login_content .loginBox .logo[data-v-4633b86c]{font-size:40px;color:#fff;margin-bottom:25px}.login_content .loginBox .logo i[data-v-4633b86c]{font-size:50px;margin-right:20px}.login_content .loginBox .form .btn .button[data-v-4633b86c]{cursor:pointer;width:200px;height:35px;line-height:35px;border-radius:35px;text-align:center;color:#fff;background-color:#5af}.login_content .loginBox .tools[data-v-4633b86c]{margin-top:20px}.login_content .loginBox .tools .tool[data-v-4633b86c]{margin:0 10px;cursor:pointer;color:#fff;font-size:25px}.login_content .loginBox .tools .tool[data-v-4633b86c]:hover{color:#0ff}",""]),e.exports=t},cebe:function(e,t,n){var a=n("4c4c");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var o=n("4f06").default;o("5aeb8524",a,!0,{sourceMap:!1,shadowMode:!1})},deda:function(e,t,n){"use strict";n.r(t);var a=n("78b0"),o=n("ba5e");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);n("8cc7");var i,c=n("f0c5"),s=Object(c["a"])(o["default"],a["b"],a["c"],!1,null,"1ec2b934",null,!1,a["a"],i);t["default"]=s.exports},e0a4:function(e,t,n){var a=n("27ca");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var o=n("4f06").default;o("42d38539",a,!0,{sourceMap:!1,shadowMode:!1})},efac:function(e,t,n){"use strict";var a=n("c260"),o=n.n(a);o.a}}]);